<!DOCTYPE html>
<html>
<head>
  <title>Appendix B - Graphical user interfaces</title>
  <link rel="stylesheet" href="https://unpkg.com/@primer/css@^20.2.4/dist/primer.css">
  <link rel="stylesheet" href="pygments.css">
</head>
<body>
<div class="container-lg p-4">
<div class="col-12">
<div class="markdown-body border rounded-3 p-6">
<h1 id="appendix-b-graphical-user-interfaces">Appendix B - Graphical user interfaces</h1>

<p>This appendix provides a brief introduction to implementing graphical user interfaces for Jason projects. Such interfaces are typically spawned from a custom environment class, so you should complete <a href="appendix-a.html">Appendix A</a> before proceeding.</p>

<ul>
<li><a href="#getting-started">Getting started</a>
<ul>
<li><a href="#step-1-simple-jason-project">Step 1 - Simple Jason project</a></li>
</ul></li>
<li><a href="#java-interfaces">Java interfaces</a>
<ul>
<li><a href="#step-2-swing-interface">Step 2 - Swing interface</a></li>
<li><a href="#step-3-spawn-the-interface">Step 3 - Spawn the interface</a></li>
<li><a href="#step-4-user-input">Step 4 - User input</a></li>
</ul></li>
<li><a href="#web-interfaces">Web interfaces</a>
<ul>
<li><a href="#step-5-javalin-api-server">Step 5 - Javalin API server</a></li>
<li><a href="#step-6-api-endpoints">Step 6 - API endpoints</a></li>
<li><a href="#step-7-submit-api-requests">Step 7 - Submit API requests</a></li>
</ul></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>

<h2 id="getting-started">Getting started</h2>

<p>Create a new Jason project in Eclipse called <code>appendix_b</code>.</p>

<h3 id="step-1-simple-jason-project">Step 1 - Simple Jason project</h3>

<p>Create a new custom environment class file called <code>MyEnvironment.java</code>:</p>

<div class="codehilite">
<pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">appendix_b</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">jason.environment.Environment</span><span class="p">;</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyEnvironment</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Environment</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">init</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="p">}</span>

<span class="p">}</span>
</code></pre>
</div>

<p>Create a new agent file called <code>interface_agent.asl</code>:</p>

<div class="codehilite">
<pre><span></span><code><span class="cm">/* Initial beliefs and rules */</span>

<span class="cm">/* Initial goals */</span>

<span class="cm">/* Plans */</span>

<span class="nf">+my_percept</span><span class="p">(</span><span class="nv">X</span><span class="p">)[</span><span class="nf">source</span><span class="p">(</span><span class="nv">Y</span><span class="p">)]</span> <span class="p">:</span> <span class="k">true</span> <span class="p">&lt;-</span> <span class="nb">.print</span><span class="p">(</span><span class="s2">&quot;Belief added: &quot;</span><span class="p">,</span> <span class="nf">my_percept</span><span class="p">(</span><span class="nv">X</span><span class="p">)[</span><span class="nf">source</span><span class="p">(</span><span class="nv">Y</span><span class="p">)]).</span>

<span class="nf">-my_percept</span><span class="p">(</span><span class="nv">X</span><span class="p">)[</span><span class="nf">source</span><span class="p">(</span><span class="nv">Y</span><span class="p">)]</span> <span class="p">:</span> <span class="k">true</span> <span class="p">&lt;-</span> <span class="nb">.print</span><span class="p">(</span><span class="s2">&quot;Belief deleted: &quot;</span><span class="p">,</span> <span class="nf">my_percept</span><span class="p">(</span><span class="nv">X</span><span class="p">)[</span><span class="nf">source</span><span class="p">(</span><span class="nv">Y</span><span class="p">)]).</span>
</code></pre>
</div>

<p>According to this agent file the agent will print a message whenever a belief of the form <code>my_percept(X)</code> is added or deleted from its belief base.</p>

<p>Edit the Jason configuration file as follows:</p>

<div class="codehilite">
<pre><span></span><code><span class="nv">MAS</span> <span class="s s-Atom">appendix_b</span> <span class="p">{</span>

    <span class="s s-Atom">infrastructure</span><span class="p">:</span> <span class="nv">Centralised</span>

    <span class="s s-Atom">environment</span><span class="p">:</span> <span class="nb">appendix_b.MyEnvironment</span>

    <span class="s s-Atom">agents</span><span class="p">:</span>
        <span class="s s-Atom">alice</span> <span class="s s-Atom">interface_agent</span><span class="p">;</span>
        <span class="s s-Atom">bob</span> <span class="s s-Atom">interface_agent</span><span class="p">;</span>

    <span class="s s-Atom">aslSourcePath</span><span class="p">:</span>
        <span class="s2">&quot;src/asl&quot;</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Run the Jason project.</p>

<p>The Jason console should launch but no message should appear. The reason is that agents <code>alice</code> and <code>bob</code> are purely reactive; if a belief of the form <code>my_percept(X)</code> is never added or deleted from their belief base then they will do nothing. Later we will seek to trigger this behaviour via a graphical user interface.</p>

<h2 id="java-interfaces">Java interfaces</h2>

<p>The most common approach to implementing graphical user interfaces in Jason is to use an existing Java widget toolkit, such as <a href="https://en.wikipedia.org/wiki/Swing_(Java)">Swing</a> or <a href="https://en.wikipedia.org/wiki/Standard_Widget_Toolkit">SWT</a>. This is the approach typically used by Jason example/demo implementations available online.</p>

<h3 id="step-2-swing-interface">Step 2 - Swing interface</h3>

<p>With the <code>src/java</code> directory in the Jason project highlighted in Eclipse select <strong>File &gt; New &gt; Class</strong>.</p>

<p>Enter <code>MyWindow</code> in the <strong>Name</strong> field and select <strong>Finish</strong>.</p>

<p>A new Java file should be automatically created at <code>src/java/appendix_b/MyWindow.java</code>. Edit the file as follows:</p>

<div class="codehilite">
<pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">appendix_b</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.awt.event.ActionEvent</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.awt.event.ActionListener</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">javax.swing.DefaultListModel</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">javax.swing.JButton</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">javax.swing.JComboBox</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">javax.swing.JFrame</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">javax.swing.JLabel</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">javax.swing.JList</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">javax.swing.JPanel</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">javax.swing.JScrollPane</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">javax.swing.JTextField</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">jason.asSyntax.ASSyntax</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jason.asSyntax.Literal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jason.asSyntax.parser.ParseException</span><span class="p">;</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyWindow</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n">MyEnvironment</span><span class="w"> </span><span class="n">myEnv</span><span class="p">;</span>
<span class="w">    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">myAgents</span><span class="p">;</span>

<span class="w">    </span><span class="n">JComboBox</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">agentComboBox</span><span class="p">;</span>
<span class="w">    </span><span class="n">DefaultListModel</span><span class="o">&lt;</span><span class="n">Literal</span><span class="o">&gt;</span><span class="w"> </span><span class="n">perceptListModel</span><span class="p">;</span>
<span class="w">    </span><span class="n">JList</span><span class="o">&lt;</span><span class="n">Literal</span><span class="o">&gt;</span><span class="w"> </span><span class="n">perceptList</span><span class="p">;</span>
<span class="w">    </span><span class="n">JTextField</span><span class="w"> </span><span class="n">addTextfield</span><span class="p">;</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">MyWindow</span><span class="p">(</span><span class="n">MyEnvironment</span><span class="w"> </span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">agents</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">myEnv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">env</span><span class="p">;</span>
<span class="w">        </span><span class="n">myAgents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">agents</span><span class="p">;</span>

<span class="w">        </span><span class="n">agentComboBox</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JComboBox</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="p">(</span><span class="n">myAgents</span><span class="p">);</span>
<span class="w">        </span><span class="n">agentComboBox</span><span class="p">.</span><span class="na">addActionListener</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ActionListener</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">actionPerformed</span><span class="p">(</span><span class="n">ActionEvent</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nd">@SuppressWarnings</span><span class="p">(</span><span class="s">&quot;unchecked&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="n">JComboBox</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">eComboBox</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">JComboBox</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getSource</span><span class="p">();</span>
<span class="w">                </span><span class="n">String</span><span class="w"> </span><span class="n">agent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="n">eComboBox</span><span class="p">.</span><span class="na">getSelectedItem</span><span class="p">();</span>
<span class="w">                </span><span class="n">refreshPerceptList</span><span class="p">(</span><span class="n">agent</span><span class="p">);</span><span class="w">  </span><span class="c1">// Refresh the scroll pane whenever the user interacts with the combo box</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">});</span>

<span class="w">        </span><span class="n">perceptListModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DefaultListModel</span><span class="o">&lt;</span><span class="n">Literal</span><span class="o">&gt;</span><span class="p">();</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">agent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="n">agentComboBox</span><span class="p">.</span><span class="na">getSelectedItem</span><span class="p">();</span>
<span class="w">        </span><span class="n">refreshPerceptList</span><span class="p">(</span><span class="n">agent</span><span class="p">);</span>

<span class="w">        </span><span class="n">perceptList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JList</span><span class="o">&lt;</span><span class="n">Literal</span><span class="o">&gt;</span><span class="p">(</span><span class="n">perceptListModel</span><span class="p">);</span>
<span class="w">        </span><span class="n">perceptList</span><span class="p">.</span><span class="na">setVisibleRowCount</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>

<span class="w">        </span><span class="n">addTextfield</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JTextField</span><span class="p">(</span><span class="s">&quot;my_percept(1)&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">);</span>

<span class="w">        </span><span class="n">JButton</span><span class="w"> </span><span class="n">addAgentButton</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JButton</span><span class="p">(</span><span class="s">&quot;Add (agent)&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">addAgentButton</span><span class="p">.</span><span class="na">addActionListener</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ActionListener</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">actionPerformed</span><span class="p">(</span><span class="n">ActionEvent</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">String</span><span class="w"> </span><span class="n">agent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="n">agentComboBox</span><span class="p">.</span><span class="na">getSelectedItem</span><span class="p">();</span>
<span class="w">                    </span><span class="n">Literal</span><span class="w"> </span><span class="n">percept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ASSyntax</span><span class="p">.</span><span class="na">parseLiteral</span><span class="p">(</span><span class="n">addTextfield</span><span class="p">.</span><span class="na">getText</span><span class="p">());</span>
<span class="w">                    </span><span class="n">percept</span><span class="p">.</span><span class="na">addAnnot</span><span class="p">(</span><span class="n">ASSyntax</span><span class="p">.</span><span class="na">parseTerm</span><span class="p">(</span><span class="s">&quot;scope(agent)&quot;</span><span class="p">));</span><span class="w">  </span><span class="c1">// Add custom annotation to explicitly identify percepts in the GUI</span>
<span class="w">                    </span><span class="n">myEnv</span><span class="p">.</span><span class="na">addPercept</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span><span class="w"> </span><span class="n">percept</span><span class="p">);</span><span class="w">  </span><span class="c1">// Add percept for the selected agent</span>
<span class="w">                    </span><span class="n">refreshPerceptList</span><span class="p">(</span><span class="n">agent</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">ParseException</span><span class="w"> </span><span class="n">e1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">e1</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">});</span>

<span class="w">        </span><span class="n">JButton</span><span class="w"> </span><span class="n">addSharedButton</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JButton</span><span class="p">(</span><span class="s">&quot;Add (shared)&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">addSharedButton</span><span class="p">.</span><span class="na">addActionListener</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ActionListener</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">actionPerformed</span><span class="p">(</span><span class="n">ActionEvent</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">String</span><span class="w"> </span><span class="n">agent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="n">agentComboBox</span><span class="p">.</span><span class="na">getSelectedItem</span><span class="p">();</span>
<span class="w">                    </span><span class="n">Literal</span><span class="w"> </span><span class="n">percept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ASSyntax</span><span class="p">.</span><span class="na">parseLiteral</span><span class="p">(</span><span class="n">addTextfield</span><span class="p">.</span><span class="na">getText</span><span class="p">());</span>
<span class="w">                    </span><span class="n">percept</span><span class="p">.</span><span class="na">addAnnot</span><span class="p">(</span><span class="n">ASSyntax</span><span class="p">.</span><span class="na">parseTerm</span><span class="p">(</span><span class="s">&quot;scope(shared)&quot;</span><span class="p">));</span><span class="w">  </span><span class="c1">// Add custom annotation to explicitly identify shared percepts in the GUI</span>
<span class="w">                    </span><span class="n">myEnv</span><span class="p">.</span><span class="na">addPercept</span><span class="p">(</span><span class="n">percept</span><span class="p">);</span><span class="w">  </span><span class="c1">// Add shared percept</span>
<span class="w">                    </span><span class="n">refreshPerceptList</span><span class="p">(</span><span class="n">agent</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">ParseException</span><span class="w"> </span><span class="n">e1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">e1</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">});</span>

<span class="w">        </span><span class="n">JButton</span><span class="w"> </span><span class="n">removeButton</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JButton</span><span class="p">(</span><span class="s">&quot;Remove&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">removeButton</span><span class="p">.</span><span class="na">addActionListener</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ActionListener</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">actionPerformed</span><span class="p">(</span><span class="n">ActionEvent</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">perceptList</span><span class="p">.</span><span class="na">isSelectionEmpty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">String</span><span class="w"> </span><span class="n">agent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="n">agentComboBox</span><span class="p">.</span><span class="na">getSelectedItem</span><span class="p">();</span>
<span class="w">                    </span><span class="n">Literal</span><span class="w"> </span><span class="n">percept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Literal</span><span class="p">)</span><span class="w"> </span><span class="n">perceptList</span><span class="p">.</span><span class="na">getSelectedValue</span><span class="p">();</span>
<span class="w">                    </span><span class="n">String</span><span class="w"> </span><span class="n">scope</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">percept</span><span class="p">.</span><span class="na">getAnnot</span><span class="p">(</span><span class="s">&quot;scope&quot;</span><span class="p">).</span><span class="na">getTerm</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="na">toString</span><span class="p">();</span><span class="w">  </span><span class="c1">// Retrieve the custom annotation to determine what method to call</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">scope</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;agent&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">myEnv</span><span class="p">.</span><span class="na">removePercept</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span><span class="w"> </span><span class="n">percept</span><span class="p">);</span><span class="w">  </span><span class="c1">// Remove percept for the selected agent</span>
<span class="w">                    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">myEnv</span><span class="p">.</span><span class="na">removePercept</span><span class="p">(</span><span class="n">percept</span><span class="p">);</span><span class="w">  </span><span class="c1">// Remove shared percept</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                    </span><span class="n">refreshPerceptList</span><span class="p">(</span><span class="n">agent</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">});</span>

<span class="w">        </span><span class="n">JButton</span><span class="w"> </span><span class="n">clearAgentButton</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JButton</span><span class="p">(</span><span class="s">&quot;Clear (agent)&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">clearAgentButton</span><span class="p">.</span><span class="na">addActionListener</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ActionListener</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">actionPerformed</span><span class="p">(</span><span class="n">ActionEvent</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">String</span><span class="w"> </span><span class="n">agent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="n">agentComboBox</span><span class="p">.</span><span class="na">getSelectedItem</span><span class="p">();</span>
<span class="w">                </span><span class="n">myEnv</span><span class="p">.</span><span class="na">clearPercepts</span><span class="p">(</span><span class="n">agent</span><span class="p">);</span><span class="w">  </span><span class="c1">// Clear percepts for the selected agent</span>
<span class="w">                </span><span class="n">refreshPerceptList</span><span class="p">(</span><span class="n">agent</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">});</span>

<span class="w">        </span><span class="n">JButton</span><span class="w"> </span><span class="n">clearSharedButton</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JButton</span><span class="p">(</span><span class="s">&quot;Clear (shared)&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">clearSharedButton</span><span class="p">.</span><span class="na">addActionListener</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ActionListener</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">actionPerformed</span><span class="p">(</span><span class="n">ActionEvent</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">String</span><span class="w"> </span><span class="n">agent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="n">agentComboBox</span><span class="p">.</span><span class="na">getSelectedItem</span><span class="p">();</span>
<span class="w">                </span><span class="n">myEnv</span><span class="p">.</span><span class="na">clearPercepts</span><span class="p">();</span><span class="w">  </span><span class="c1">// Clear shared percepts</span>
<span class="w">                </span><span class="n">refreshPerceptList</span><span class="p">(</span><span class="n">agent</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">});</span>

<span class="w">        </span><span class="n">JPanel</span><span class="w"> </span><span class="n">panel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JPanel</span><span class="p">();</span>
<span class="w">        </span><span class="n">panel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">JLabel</span><span class="p">(</span><span class="s">&quot;Agent&quot;</span><span class="p">));</span>
<span class="w">        </span><span class="n">panel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">agentComboBox</span><span class="p">);</span>
<span class="w">        </span><span class="n">panel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">JLabel</span><span class="p">(</span><span class="s">&quot;Percept&quot;</span><span class="p">));</span>
<span class="w">        </span><span class="n">panel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">addTextfield</span><span class="p">);</span>
<span class="w">        </span><span class="n">panel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">addAgentButton</span><span class="p">);</span>
<span class="w">        </span><span class="n">panel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">addSharedButton</span><span class="p">);</span>
<span class="w">        </span><span class="n">panel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">JScrollPane</span><span class="p">(</span><span class="n">perceptList</span><span class="p">));</span>
<span class="w">        </span><span class="n">panel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">removeButton</span><span class="p">);</span>
<span class="w">        </span><span class="n">panel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">clearAgentButton</span><span class="p">);</span>
<span class="w">        </span><span class="n">panel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">clearSharedButton</span><span class="p">);</span>

<span class="w">        </span><span class="n">JFrame</span><span class="w"> </span><span class="n">frame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JFrame</span><span class="p">(</span><span class="s">&quot;Percept manager&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">frame</span><span class="p">.</span><span class="na">getContentPane</span><span class="p">().</span><span class="na">add</span><span class="p">(</span><span class="n">panel</span><span class="p">);</span>
<span class="w">        </span><span class="n">frame</span><span class="p">.</span><span class="na">pack</span><span class="p">();</span>
<span class="w">        </span><span class="n">frame</span><span class="p">.</span><span class="na">setVisible</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/*</span>
<span class="cm">     * Refresh contents of the scroll pane based on the selected agent</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">refreshPerceptList</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">agent</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">perceptListModel</span><span class="p">.</span><span class="na">removeAllElements</span><span class="p">();</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Literal</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">myEnv</span><span class="p">.</span><span class="na">consultPercepts</span><span class="p">(</span><span class="n">agent</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">perceptListModel</span><span class="p">.</span><span class="na">addElement</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="p">}</span>
</code></pre>
</div>

<p>This class uses standard widgets from Swing to implement a desktop window that integrates with the Jason virtual environment via event listeners.</p>

<p>According to the constructor, an instance of the class is initialised with an instance of our virtual environment and an array of agent names. The former allows us to conveniently access Jason functionality within the <code>MyWindow</code> class itself, while the latter allows us to make use of agent names within the interface.</p>

<h3 id="step-3-spawn-the-interface">Step 3 - Spawn the interface</h3>

<p>The final step is to spawn the interface from within the <code>init</code> method of the virtual environment class.</p>

<p>Add the following lines to the <code>init</code> method of <code>MyEnvironment.java</code>:</p>

<div class="codehilite">
<pre><span></span><code><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">agents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;alice&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;bob&quot;</span><span class="p">};</span>
<span class="k">new</span><span class="w"> </span><span class="n">MyWindow</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">agents</span><span class="p">);</span>
</code></pre>
</div>

<p>The line <code>new MyWindow(this, agents)</code> spawns the new interface by passing the current environment (<code>this</code>) along with an array of agents names (<code>agents</code>).</p>

<blockquote>
  <p><strong>Note:</strong> Details on how to access the list of agent names <strong>automatically</strong> can be found in the <a href="https://jason-lang.github.io/doc/faq#_how_to_discover_the_name_of_the_agents_in_the_environment_initialisation">Jason FAQ</a>.</p>
</blockquote>

<h3 id="step-4-user-input">Step 4 - User input</h3>

<p>Run the Jason project.</p>

<p>The following window called <code>Percept manager</code> should appear:</p>

<p><img src="figures/gui-1.png" alt="Figure" /></p>

<p>The empty box in the centre displays a selectable list of percepts for the agent highlighted in the dropdown menu to the far left. Initially <code>alice</code> is highlighted and she has no percepts.</p>

<p>The box displaying <code>my_percept(1)</code> is an editable text field that allows you to enter any arbitrary percept, which can then be added as a percept of the highlighted agent using the <code>Add (agent)</code> button, or as a shared percept for all agents using the <code>Add (shared)</code> button.</p>

<p>Select the <code>Add (agent)</code> button. An annotated percept <code>my_percept(1)[scope(agent)]</code> should appear in the list, where <code>scope(agent)</code> is a custom annotation used by the interface to distinguish agent percepts from shared percepts.</p>

<p><img src="figures/gui-2.png" alt="Figure" /></p>

<p>The Jason console should also display the following message:</p>

<div class="codehilite">
<pre><span></span><code>[alice] Belief added: my_percept(1)[source(percept)]
</code></pre>
</div>

<p>Edit the text field to <code>my_percept(2)</code> and select <code>Add (agent)</code>.  An annotated percept <code>my_percept(2)[scope(agent)]</code> should appear in the list.</p>

<p><img src="figures/gui-3.png" alt="Figure" /></p>

<div class="codehilite">
<pre><span></span><code>[alice] Belief added: my_percept(2)[source(percept)]
</code></pre>
</div>

<p>Edit the text field to <code>my_percept(3)</code> and select <code>Add (shared)</code>.  An annotated percept <code>my_percept(3)[scope(shared)]</code> should appear in the list.</p>

<p><img src="figures/gui-4.png" alt="Figure" /></p>

<div class="codehilite">
<pre><span></span><code>[bob] Belief added: my_percept(3)[source(percept)]
[alice] Belief added: my_percept(3)[source(percept)]
</code></pre>
</div>

<p>Select <code>bob</code> from the dropdown menu. The list should only display the shared percept  <code>my_percept(3)[scope(shared)]</code>.</p>

<p><img src="figures/gui-5.png" alt="Figure" /></p>

<p>Edit the text field to <code>my_percept(4)</code> and select <code>Add (agent)</code>.  An annotated percept <code>my_percept(4)[scope(agent)]</code> should appear in the list.</p>

<p><img src="figures/gui-6.png" alt="Figure" /></p>

<div class="codehilite">
<pre><span></span><code>[bob] Belief added: my_percept(4)[source(percept)]
</code></pre>
</div>

<p>Edit the text field to <code>my_percept(5)</code> and select <code>Add (shared)</code>.  An annotated percept <code>my_percept(5)[scope(shared)]</code> should appear in the list.</p>

<p><img src="figures/gui-7.png" alt="Figure" /></p>

<div class="codehilite">
<pre><span></span><code>[bob] Belief added: my_percept(5)[source(percept)]
[alice] Belief added: my_percept(5)[source(percept)]
</code></pre>
</div>

<p>Select <code>alice</code> from the dropdown menu. The list for <code>alice</code> should appear as before with the addition of the shared percept  <code>my_percept(5)[scope(shared)]</code>.</p>

<p><img src="figures/gui-8.png" alt="Figure" /></p>

<p>Select <code>my_percept(1)[scope(agent)]</code> from the list and select <code>Remove</code>. The percept should be removed from the list.</p>

<p><img src="figures/gui-9.png" alt="Figure" /></p>

<div class="codehilite">
<pre><span></span><code>[alice] Belief deleted: my_percept(1)[source(percept)]
</code></pre>
</div>

<p>Select <code>Clear (agent)</code>. All percepts with <code>scope(agent)</code> should be removed from the list.</p>

<p><img src="figures/gui-10.png" alt="Figure" /></p>

<div class="codehilite">
<pre><span></span><code>[alice] Belief deleted: my_percept(2)[source(percept)]
</code></pre>
</div>

<p>Select <code>bob</code> from the dropdown menu. The list should appear as before.</p>

<p><img src="figures/gui-11.png" alt="Figure" /></p>

<p>Select <code>Clear (shared)</code>. All percepts with <code>scope(shared)</code> should be removed from the list.</p>

<p><img src="figures/gui-12.png" alt="Figure" /></p>

<div class="codehilite">
<pre><span></span><code>[bob] Belief deleted: my_percept(3)[source(percept)]
[bob] Belief deleted: my_percept(5)[source(percept)]
[alice] Belief deleted: my_percept(3)[source(percept)]
[alice] Belief deleted: my_percept(5)[source(percept)]
</code></pre>
</div>

<p>Select <code>alice</code> from the dropdown menu. The list should now be empty.</p>

<p><img src="figures/gui-13.png" alt="Figure" /></p>

<p>All functionality in the interface appears to be working as expected.</p>

<h2 id="web-interfaces">Web interfaces</h2>

<p>An alternative approach to implementing graphical user interfaces in Jason is to implement a custom API that exposes the Jason environment to external software. This approach is significantly more flexible, since you can then implement the graphical user interface using any programming language that is able to send HTTP requests (e.g. Javascript).</p>

<h3 id="step-5-javalin-api-server">Step 5 - Javalin API server</h3>

<p><a href="https://javalin.io">Javalin</a> is a popular web framework for Java. It allows you run a web server that listens on specified endpoints for standard HTTP requests, such as GET and POST. In this way you can send and retrieve data to/from the Jason environment directly, providing data to populate your graphical user interface and allowing you to implement interactivity.</p>

<p>A pre-built version of Javalin (including dependencies) is available to download <a href="javalin.jar">here</a>.</p>

<p>With the Jason project highlighted in Eclipse select <strong>File &gt; New &gt; Folder</strong>.</p>

<p>Enter <code>lib</code> in the <strong>Folder name</strong> field and select <strong>Finish</strong>.</p>

<p>Drag the file <code>javalin.jar</code> to the new <code>lib</code> directory.</p>

<p>Right-click on <code>lib/javalin.jar</code> in Eclipse and select <strong>Build Path &gt; Add to Build Path</strong>.</p>

<p>Edit <code>MyEnvironment.java</code> as follows:</p>

<div class="codehilite">
<pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">appendix_b2</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">io.javalin.Javalin</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jason.environment.Environment</span><span class="p">;</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyEnvironment</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Environment</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">init</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Javalin</span><span class="w"> </span><span class="n">app</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Javalin</span><span class="p">.</span><span class="na">create</span><span class="p">().</span><span class="na">start</span><span class="p">(</span><span class="mi">7000</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="p">}</span>
</code></pre>
</div>

<p>Run the Jason project. The Jason console should display the following:</p>

<div class="codehilite">
<pre><span></span><code>[main] INFO io.javalin.Javalin - 
           __                      __ _
          / /____ _ _   __ ____ _ / /(_)____
     __  / // __ `/| | / // __ `// // // __ \
    / /_/ // /_/ / | |/ // /_/ // // // / / /
    \____/ \__,_/  |___/ \__,_//_//_//_/ /_/

        https://javalin.io/documentation

[main] INFO org.eclipse.jetty.util.log - Logging initialized @1576ms to org.eclipse.jetty.util.log.Slf4jLog
[main] INFO io.javalin.Javalin - Starting Javalin ...
[main] INFO io.javalin.Javalin - Listening on http://localhost:7000/
[main] INFO io.javalin.Javalin - Javalin started in 367ms \o/
</code></pre>
</div>

<p>This confirms that Javalin is working correctly and listening on <a href="http://localhost:7000/">http://localhost:7000/</a>.</p>

<h3 id="step-6-api-endpoints">Step 6 - API endpoints</h3>

<p>A custom API based on Javalin can be implemented within the <code>init</code> method of the custom environment class. This requires you to specify some API endpoints, including how any data should be handled.</p>

<p>Edit <code>MyEnvironment.java</code> as follows:</p>

<div class="codehilite">
<pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">appendix_b2</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.ArrayList</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Collection</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">io.javalin.Javalin</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jason.asSyntax.ASSyntax</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jason.asSyntax.Literal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jason.environment.Environment</span><span class="p">;</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyEnvironment</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Environment</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">init</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Javalin</span><span class="w"> </span><span class="n">app</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Javalin</span><span class="p">.</span><span class="na">create</span><span class="p">().</span><span class="na">start</span><span class="p">(</span><span class="mi">7000</span><span class="p">);</span>

<span class="w">        </span><span class="n">app</span><span class="p">.</span><span class="na">post</span><span class="p">(</span><span class="s">&quot;/percepts/add/:agent&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ctx</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">agent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="na">pathParam</span><span class="p">(</span><span class="s">&quot;agent&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">Literal</span><span class="w"> </span><span class="n">percept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ASSyntax</span><span class="p">.</span><span class="na">parseLiteral</span><span class="p">(</span><span class="n">ctx</span><span class="p">.</span><span class="na">body</span><span class="p">());</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">addPercept</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span><span class="w"> </span><span class="n">percept</span><span class="p">);</span>
<span class="w">        </span><span class="p">});</span>

<span class="w">        </span><span class="n">app</span><span class="p">.</span><span class="na">post</span><span class="p">(</span><span class="s">&quot;/percepts/add&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ctx</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Literal</span><span class="w"> </span><span class="n">percept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ASSyntax</span><span class="p">.</span><span class="na">parseLiteral</span><span class="p">(</span><span class="n">ctx</span><span class="p">.</span><span class="na">body</span><span class="p">());</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">addPercept</span><span class="p">(</span><span class="n">percept</span><span class="p">);</span>
<span class="w">        </span><span class="p">});</span>

<span class="w">        </span><span class="n">app</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&quot;/percepts/:agent&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ctx</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">agent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="na">pathParam</span><span class="p">(</span><span class="s">&quot;agent&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">Collection</span><span class="o">&lt;</span><span class="n">Literal</span><span class="o">&gt;</span><span class="w"> </span><span class="n">percepts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">consultPercepts</span><span class="p">(</span><span class="n">agent</span><span class="p">);</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">percepts</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">percepts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Literal</span><span class="o">&gt;</span><span class="p">();</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="n">ctx</span><span class="p">.</span><span class="na">result</span><span class="p">(</span><span class="n">percepts</span><span class="p">.</span><span class="na">toString</span><span class="p">());</span>
<span class="w">        </span><span class="p">});</span>

<span class="w">        </span><span class="n">app</span><span class="p">.</span><span class="na">post</span><span class="p">(</span><span class="s">&quot;/percepts/remove/:agent&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ctx</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">agent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="na">pathParam</span><span class="p">(</span><span class="s">&quot;agent&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">Literal</span><span class="w"> </span><span class="n">percept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ASSyntax</span><span class="p">.</span><span class="na">parseLiteral</span><span class="p">(</span><span class="n">ctx</span><span class="p">.</span><span class="na">body</span><span class="p">());</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">removePercept</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span><span class="w"> </span><span class="n">percept</span><span class="p">);</span>
<span class="w">        </span><span class="p">});</span>

<span class="w">        </span><span class="n">app</span><span class="p">.</span><span class="na">post</span><span class="p">(</span><span class="s">&quot;/percepts/remove&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ctx</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Literal</span><span class="w"> </span><span class="n">percept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ASSyntax</span><span class="p">.</span><span class="na">parseLiteral</span><span class="p">(</span><span class="n">ctx</span><span class="p">.</span><span class="na">body</span><span class="p">());</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">removePercept</span><span class="p">(</span><span class="n">percept</span><span class="p">);</span>
<span class="w">        </span><span class="p">});</span>

<span class="w">        </span><span class="n">app</span><span class="p">.</span><span class="na">post</span><span class="p">(</span><span class="s">&quot;/percepts/clear/:agent&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ctx</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">agent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="na">pathParam</span><span class="p">(</span><span class="s">&quot;agent&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">clearPercepts</span><span class="p">(</span><span class="n">agent</span><span class="p">);</span>
<span class="w">        </span><span class="p">});</span>

<span class="w">        </span><span class="n">app</span><span class="p">.</span><span class="na">post</span><span class="p">(</span><span class="s">&quot;/percepts/clear&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ctx</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">clearPercepts</span><span class="p">();</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="p">}</span>
</code></pre>
</div>

<blockquote>
  <p><strong>Note:</strong> If you see an Eclipse error for <code>ctx</code> you may need to hover your cursor over the error and select <code>Change project compliance and JRE to 1.8</code>.</p>
</blockquote>

<p>This code implements the following API specification:</p>

<table>
<thead>
<tr>
  <th>Method</th>
  <th>Endpoint</th>
  <th>Data</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td>POST</td>
  <td><code>/percepts/add/{agent}</code></td>
  <td><code>{percept}</code></td>
  <td>Add <code>{percept}</code> as a percept for <code>{agent}</code></td>
</tr>
<tr>
  <td>POST</td>
  <td><code>/percepts/add</code></td>
  <td><code>{percept}</code></td>
  <td>Add <code>{percept}</code> as a shared percept</td>
</tr>
<tr>
  <td>GET</td>
  <td><code>/percepts/{agent}</code></td>
  <td>N/A</td>
  <td>Get all percepts for <code>{agent}</code></td>
</tr>
<tr>
  <td>POST</td>
  <td><code>/percepts/remove/{agent}</code></td>
  <td><code>{percept}</code></td>
  <td>Remove <code>{percept}</code> as a percept for <code>{agent}</code></td>
</tr>
<tr>
  <td>POST</td>
  <td><code>/percepts/remove</code></td>
  <td><code>{percept}</code></td>
  <td>Remove <code>{percept}</code> as a shared percept</td>
</tr>
<tr>
  <td>POST</td>
  <td><code>/percepts/clear/{agent}</code></td>
  <td>N/A</td>
  <td>Clear all percepts for <code>{agent}</code></td>
</tr>
<tr>
  <td>POST</td>
  <td><code>/percepts/clear</code></td>
  <td>N/A</td>
  <td>Clear all shared percepts</td>
</tr>
</tbody>
</table>

<p>These endpoints thus provide access to all Jason features used by the previous Swing interface.</p>

<h3 id="step-7-submit-api-requests">Step 7 - Submit API requests</h3>

<p>The new API can be tested using the command-line tool <a href="https://en.wikipedia.org/wiki/CURL">cURL</a> to issue appropriate HTTP requests.</p>

<p>In a terminal run the following command to add <code>my_percept(1)</code> as a percept for <code>alice</code>:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>--request<span class="w"> </span>POST<span class="w"> </span>http://localhost:7000/percepts/add/alice<span class="w"> </span>--data<span class="w"> </span><span class="s2">&quot;my_percept(1)&quot;</span>
</code></pre>
</div>

<p>The Jason console should display the following message:</p>

<div class="codehilite">
<pre><span></span><code>[alice] Belief added: my_percept(1)[source(percept)]
</code></pre>
</div>

<p>Add <code>my_percept(2)</code> as a percept for <code>alice</code>:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>--request<span class="w"> </span>POST<span class="w"> </span>http://localhost:7000/percepts/add/alice<span class="w"> </span>--data<span class="w"> </span><span class="s2">&quot;my_percept(2)&quot;</span>
</code></pre>
</div>

<div class="codehilite">
<pre><span></span><code>[alice] Belief added: my_percept(2)[source(percept)]
</code></pre>
</div>

<p>Add <code>my_percept(3)</code> as a shared percept:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>--request<span class="w"> </span>POST<span class="w"> </span>http://localhost:7000/percepts/add<span class="w"> </span>--data<span class="w"> </span><span class="s2">&quot;my_percept(3)&quot;</span>
</code></pre>
</div>

<div class="codehilite">
<pre><span></span><code>[alice] Belief added: my_percept(3)[source(percept)]
[bob] Belief added: my_percept(3)[source(percept)]
</code></pre>
</div>

<p>Retrieve the percepts for <code>alice</code>:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>--request<span class="w"> </span>GET<span class="w"> </span>http://localhost:7000/percepts/alice
<span class="o">[</span>my_percept<span class="o">(</span><span class="m">3</span><span class="o">)</span>,<span class="w"> </span>my_percept<span class="o">(</span><span class="m">1</span><span class="o">)</span>,<span class="w"> </span>my_percept<span class="o">(</span><span class="m">2</span><span class="o">)]</span>
</code></pre>
</div>

<p>Retrieve the percepts for <code>bob</code>:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>--request<span class="w"> </span>GET<span class="w"> </span>http://localhost:7000/percepts/bob
<span class="o">[</span>my_percept<span class="o">(</span><span class="m">3</span><span class="o">)]</span>
</code></pre>
</div>

<p>Add <code>my_percept(4)</code> as a percept for <code>bob</code>:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>--request<span class="w"> </span>POST<span class="w"> </span>http://localhost:7000/percepts/add/bob<span class="w"> </span>--data<span class="w"> </span><span class="s2">&quot;my_percept(4)&quot;</span>
</code></pre>
</div>

<div class="codehilite">
<pre><span></span><code>[bob] Belief added: my_percept(4)[source(percept)]
</code></pre>
</div>

<p>Add <code>my_percept(5)</code> as a shared percept:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>--request<span class="w"> </span>POST<span class="w"> </span>http://localhost:7000/percepts/add<span class="w"> </span>--data<span class="w"> </span><span class="s2">&quot;my_percept(5)&quot;</span>
</code></pre>
</div>

<div class="codehilite">
<pre><span></span><code>[bob] Belief added: my_percept(5)[source(percept)]
[alice] Belief added: my_percept(5)[source(percept)]
</code></pre>
</div>

<p>Retrieve the percepts for <code>bob</code>:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>--request<span class="w"> </span>GET<span class="w"> </span>http://localhost:7000/percepts/bob
<span class="o">[</span>my_percept<span class="o">(</span><span class="m">3</span><span class="o">)</span>,<span class="w"> </span>my_percept<span class="o">(</span><span class="m">5</span><span class="o">)</span>,<span class="w"> </span>my_percept<span class="o">(</span><span class="m">4</span><span class="o">)]</span>
</code></pre>
</div>

<p>Retrieve the percepts for <code>alice</code>:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>--request<span class="w"> </span>GET<span class="w"> </span>http://localhost:7000/percepts/alice
<span class="o">[</span>my_percept<span class="o">(</span><span class="m">3</span><span class="o">)</span>,<span class="w"> </span>my_percept<span class="o">(</span><span class="m">5</span><span class="o">)</span>,<span class="w"> </span>my_percept<span class="o">(</span><span class="m">1</span><span class="o">)</span>,<span class="w"> </span>my_percept<span class="o">(</span><span class="m">2</span><span class="o">)]</span>
</code></pre>
</div>

<p>Remove <code>my_percept(1)</code> as a percept for <code>alice</code>:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>--request<span class="w"> </span>POST<span class="w"> </span>http://localhost:7000/percepts/remove/alice<span class="w"> </span>--data<span class="w"> </span><span class="s2">&quot;my_percept(1)&quot;</span>
</code></pre>
</div>

<div class="codehilite">
<pre><span></span><code>[alice] Belief deleted: my_percept(1)[source(percept)]
</code></pre>
</div>

<p>Clear the percepts for <code>alice</code>:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>--request<span class="w"> </span>POST<span class="w"> </span>http://localhost:7000/percepts/clear/alice
</code></pre>
</div>

<div class="codehilite">
<pre><span></span><code>[alice] Belief deleted: my_percept(2)[source(percept)]
</code></pre>
</div>

<p>Clear the shared percepts:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>--request<span class="w"> </span>POST<span class="w"> </span>http://localhost:7000/percepts/clear
</code></pre>
</div>

<div class="codehilite">
<pre><span></span><code>[bob] Belief deleted: my_percept(3)[source(percept)]
[bob] Belief deleted: my_percept(5)[source(percept)]
[alice] Belief deleted: my_percept(3)[source(percept)]
[alice] Belief deleted: my_percept(5)[source(percept)]
</code></pre>
</div>

<p>At this stage a web interface can now be implemented using Javascript or your preferred web framework.</p>

<h2 id="conclusion">Conclusion</h2>

<p>In this appendix we have seen two possible approaches to implementing graphical user interfaces for Jason projects. The first approach is to implement a desktop interface in Java using the Swing widget toolkit. The second is to embed a custom web API enabling a web interface to be implemented separately. The former is the most common approach taken by existing example/demo implementations available online, while the latter is more flexible and should be easier for those with web development experience.</p>

</div>
<footer class="p-6 mt-4">
<p class="text-center">Written by <strong>Kevin McAreavey</strong></p>
<p class="text-center">Released under <a href="https://choosealicense.com/licenses/cc-by-sa-4.0/">CC-BY-SA-4.0</a> license</p>
</footer>
</div>
</div>
</body>
</html>
